!function(t,e){"object"==typeof exports?module.exports=e():"function"==typeof define&&define.amd?define(e):t.NoiseMap=e()}(this,function(){"use strict";var r=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],M=.5*(Math.sqrt(3)-1),v=(3-Math.sqrt(3))/6,x=[],S=[{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:-1},{x:Math.SQRT1_2,y:Math.SQRT1_2},{x:-Math.SQRT1_2,y:Math.SQRT1_2},{x:Math.SQRT1_2,y:-Math.SQRT1_2},{x:-Math.SQRT1_2,y:-Math.SQRT1_2}];function f(t,e){var a,r=Math.floor(t),n=Math.floor(e),i=t-r,o=e-n,h=(a=S[7&x[(r&=255)+x[n&=255]]]).x*i+a.y*o,f=(a=S[7&x[r+x[n+1]]]).x*i+a.y*(o-1),s=(a=S[7&x[r+1+x[n]]]).x*(i-1)+a.y*o,u=(a=S[7&x[r+1+x[n+1]]]).x*(i-1)+a.y*(o-1),l=c(i);return d(c(o),d(l,h,s),d(l,f,u))}function s(t,e){var a,r,n=(t+e)*M,i=Math.floor(t+n),o=Math.floor(e+n),h=t-i+(i+o)*v,f=e-o+(i+o)*v;r=f<h?(a=1,0):(a=0,1);var s=h-a+v,u=f-r+v,l=h-1+2*v,c=f-1+2*v,d=S[7&x[(i&=255)+x[o&=255]]],g=S[7&x[i+a+x[o+r]]],y=S[7&x[i+1+x[o+1]]],p=0;return 70*(((p=.5-h*h-f*f)<0?0:(p*=p)*p*(d.x*h+d.y*f))+((p=.5-s*s-u*u)<0?0:(p*=p)*p*(g.x*s+g.y*u))+((p=.5-l*l-c*c)<0?0:(p*=p)*p*(y.x*l+y.y*c)))}function c(t){return t*t*t*(t*(6*t-15)+10)}function d(t,e,a){return(1-t)*e+t*a}function u(t,e,a,r,n){return r+(n-r)*(t-e)/(a-e)}function MapGenerator(t,e){this._seed=null,this._config={type:"simplex",amplitude:1,frequency:.5,amplitudeCoef:.5,frequencyCoef:.5,generateSeed:!1},this.setSeed(t),this.setConfig(e)}function HeightMap(t,e,a){this.width=t,this.height=e,this.size=this.width*this.height,this.data=a}MapGenerator.prototype={setSeed:function(t){var e=parseInt(t)||Math.random();e<0&&(e*=-1),0<e&&e<1&&(e*=65536),e<256&&(e|=e<<8),this._seed=e,function(t){x=new Array(512);for(var e=0,a=0;a<256;a++)e=1&a?r[a]^255&t:r[a]^t>>8&255,x[a]=x[a+256]=e}(this._seed)},setConfig:function(t){t=void 0!==t?t:{};for(var e=Object.keys(this._config),a=0;a<e.length;a++)t.hasOwnProperty(e[a])&&(this._config[e[a]]=t[e[a]])},createMap:function(t,e,a){void 0!==a&&this.setConfig(inputConfig);var r=this._config;r.generateSeed&&this.setSeed();var n="perlin"==r.type?f:s,i=function(t,e,a,r,n,i,o){var h=new Array(t*e),f=0,s=99999,u=-99999,l=0,c=0,d=0,g=0,y=0,p=0;for(g=0;g<t;g++)for(y=0;y<e;y++){for(l=a,c=n,p=d=0;p<5;p++)f=o(g/(t*c),y/(e*c)),s=Math.min(f,s),u=Math.max(f,u),d+=l*f,l*=r,c*=i;h[g+y*t]=d}return h}(t,e,r.amplitude,r.amplitudeCoef,r.frequency,r.frequencyCoef,n),o=Math.min.apply(null,i),h=Math.max.apply(null,i);return new HeightMap(t,e,i=i.map(function(t){return u(t,o,h,0,1)}))}},HeightMap.prototype={getData:function(t,e){return 0<=e&&e<this.height&&0<=t&&t<this.width?this.data[e*this.width+t]:null},scaleValues:function(t){var e=Math.max(Math.min(t,2),.5);if(1!=e)for(var a=0;a<this.data.length;a++)this.data[a]=Math.pow(this.data[a],e)},stepValues:function(t){var e=Math.max(Math.min(t,100),1);if(1<e)for(var a=0;a<this.data.length;a++)this.data[a]=Math.round(this.data[a]*e)/e},inverseValues:function(){for(var t=0;t<this.data.length;t++)this.data[t]=1-this.data[t]},draw:function(t,e,a,r,n){for(var i=Math.ceil(e/this.width),o=Math.ceil(a/this.height),h=l.new(r),f=!!n,s=0;s<this.width;s++)for(var u=0;u<this.height;u++)t.fillStyle=h.getColor(this.getData(s,u)),t.fillRect(s*i,u*o,i,o),f&&(t.fillStyle=this.getShadowColor(s,u),t.fillRect(s*i,u*o,i,o))},getShadowColor:function(t,e){var a=0,r=this.getData(t,e);return.5<=r&&(this.getData(t-1,e)>r&&(a+=.01),this.getData(t,e-1)>r&&(a+=.02),this.getData(t-1,e-1)>r&&(a+=.03)),"rgba(0,0,0,"+String(a)+")"}};var a={R:[[0,2],[63,9],[126,17],[127,69],[128,42],[191,115],[225,153],[250,179],[255,255]],G:[[0,43],[63,62],[126,82],[127,108],[128,102],[191,128],[225,143],[250,179],[255,255]],B:[[0,68],[63,92],[126,112],[127,118],[128,41],[191,77],[225,92],[250,179],[255,255]]},n={R:[[0,94],[126,66],[127,77],[128,86],[160,207],[191,254],[223,247],[255,182]],G:[[0,79],[126,138],[127,163],[128,173],[160,236],[191,235],[223,137],[255,28]],B:[[0,162],[126,181],[127,177],[128,174],[160,158],[191,159],[223,81],[255,71]]},i={R:[[0,10],[126,73],[127,109],[128,29],[160,107],[191,254],[223,207],[255,67]],G:[[0,0],[126,186],[127,219],[128,160],[160,138],[191,245],[223,131],[255,40]],B:[[0,79],[126,184],[127,184],[128,108],[160,44],[191,176],[223,55],[255,19]]},l={new:function(t){var e=null;switch(t){case"real":e=function(t){return l.getColor(t,a)};break;case"heat":e=function(t){return l.getColor(t,n)};break;case"geo":e=function(t){return l.getColor(t,i)};break;default:t="gray",e=function(t){return"hsl(0,0%,"+String(100*t)+"%)"}}return{style:t,getColor:e}},getColor:function(t,e){return"rgb("+l.interpolate(255*t,e.R)+","+l.interpolate(255*t,e.G)+","+l.interpolate(255*t,e.B)+")"},interpolate:function(t,e){for(var a=0;a<e.length;a++){if(t==e[a][0])return e[a][1];if(t<e[a][0]){var r=e[a-1],n=e[a];return Math.floor(u(t,r[0],n[0],r[1],n[1]))}}return array[array.length-1][1]}};return{MapGenerator:MapGenerator,HeightMap:HeightMap}});
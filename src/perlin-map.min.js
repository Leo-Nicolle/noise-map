!function(t,e){"object"==typeof exports?module.exports=e():"function"==typeof define&&define.amd?define(e):t.PerlinMap=e()}(this,function(){"use strict";const t=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],e=.5*(Math.sqrt(3)-1),i=(3-Math.sqrt(3))/6;var n=[{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:-1},{x:Math.SQRT1_2,y:Math.SQRT1_2},{x:-Math.SQRT1_2,y:Math.SQRT1_2},{x:Math.SQRT1_2,y:-Math.SQRT1_2},{x:-Math.SQRT1_2,y:-Math.SQRT1_2}],h=[];function a(t,e){let i,a=Math.floor(t),r=Math.floor(e),u=t-a,s=e-r,f=(i=n[7&h[(a&=255)+h[r&=255]]]).x*u+i.y*s,c=(i=n[7&h[a+h[r+1]]]).x*u+i.y*(s-1),d=(i=n[7&h[a+1+h[r]]]).x*(u-1)+i.y*s,p=(i=n[7&h[a+1+h[r+1]]]).x*(u-1)+i.y*(s-1),g=o(u);return l(o(s),l(g,f,d),l(g,c,p))}function r(t,a){let r,o,l=(t+a)*e,u=Math.floor(t+l),s=Math.floor(a+l),f=t-u+(u+s)*i,c=a-s+(u+s)*i;f>c?(r=1,o=0):(r=0,o=1);let d,p,g,y=f-r+i,M=c-o+i,m=f-1+2*i,x=c-1+2*i,S=n[7&h[(u&=255)+h[s&=255]]],w=n[7&h[u+r+h[s+o]]],R=n[7&h[u+1+h[s+1]]],C=.5-f*f-c*c;return 70*((d=C<0?0:(C*=C)*C*(S.x*f+S.y*c))+(p=(C=.5-y*y-M*M)<0?0:(C*=C)*C*(w.x*y+w.y*M))+(g=(C=.5-m*m-x*x)<0?0:(C*=C)*C*(R.x*m+R.y*x)))}function o(t){return t*t*t*(t*(6*t-15)+10)}function l(t,e,i){return(1-t)*e+t*i}function u(t,e,i,n,h){return n+(h-n)*(t-e)/(i-e)}function PerlinMap(t,e,i){this.width=t,this.height=e,this.heightmap=null,this.seed=null,this.setSeed(i),this.baseConfig={amplitude:1,frequency:.5,amplitudeCoef:.5,frequencyCoef:.5,generateSeed:!1}}PerlinMap.prototype={setSeed:function(e){let i=parseInt(e)||Math.random();i<0&&(i=-i),i>0&&i<1&&(i*=65536),i<256&&(i|=i<<8),this.seed=i,function(e){h=new Array(512);let i=0;for(let n=0;n<256;n++)i=1&n?t[n]^255&e:t[n]^e>>8&255,h[n]=h[n+256]=i}(this.seed)},compute:function(t,e){let i=function(t,e){t=t||{};let i={};for(let n in e)t.hasOwnProperty(n)?i[n]=t[n]:i[n]=e[n];return i}(e,this.baseConfig);i.generateSeed&&this.setSeed();let n=null;n="simplex"==t?r:a;let h=function(t,e,i,n,h,a,r){let o=new Array(t*e),l=0,u=99999,s=-99999,f=0,c=0,d=0,p=0,g=0,y=0;for(p=0;p<t;p++)for(g=0;g<e;g++){for(f=i,c=h,d=0,y=0;y<4;y++)l=r(p/(t*c),g/(e*c)),u=Math.min(l,u),s=Math.max(l,s),d+=f*l,f*=n,c*=a;o[p+g*t]=d}return o}(this.width,this.height,i.amplitude,i.amplitudeCoef,i.frequency,i.frequencyCoef,n),o=Math.min.apply(null,h),l=Math.max.apply(null,h);return h=h.map(function(t){return u(t,o,l,0,1)}),this.heightmap=new HeightMap(this.width,this.height,h),this.heightmap},draw(t,e,i,n,h){null!=this.heightmap&&this.heightmap.draw(t,e,i,n,h)}};const s=[[0,2],[63,9],[126,17],[127,69],[128,42],[191,115],[225,153],[250,179],[255,255]],f=[[0,43],[63,62],[126,82],[127,108],[128,102],[191,128],[225,143],[250,179],[255,255]],c=[[0,68],[63,92],[126,112],[127,118],[128,41],[191,77],[225,92],[250,179],[255,255]],d=[[0,94],[126,66],[127,77],[128,86],[160,207],[191,254],[223,247],[255,182]],p=[[0,79],[126,138],[127,163],[128,173],[160,236],[191,235],[223,137],[255,28]],g=[[0,162],[126,181],[127,177],[128,174],[160,158],[191,159],[223,81],[255,71]],y=[[0,10],[126,73],[127,109],[128,29],[160,107],[191,254],[223,207],[255,67]],M=[[0,0],[126,186],[127,219],[128,160],[160,138],[191,245],[223,131],[255,40]],m=[[0,79],[126,184],[127,184],[128,108],[160,44],[191,176],[223,55],[255,19]];function HeightMap(t,e,i){this.width=t,this.height=e,this.size=this.width*this.height,this.data=i,this.colorMap=null}function x(t,e){let i=null,n=null;for(let h=0;h<e.length;h++){if(t==e[h][0])return e[h][1];if(t<e[h][0])return i=e[h-1],n=e[h],Math.floor(u(t,i[0],n[0],i[1],n[1]))}return e[e.length-1][1]}return HeightMap.prototype={getData:function(t,e){return e>=0&&e<this.height&&t>=0&&t<this.width?this.data[e*this.width+t]:null},scaleValues:function(t){var e=Math.max(Math.min(t,2),.5);1!=e&&(this.data=this.data.map(function(t){return Math.pow(t,e)}))},floorValues:function(t){let e=Math.max(Math.min(t,100),1);e>1&&(this.data=this.data.map(function(t){return Math.round(t*e)/e}))},inverseValues:function(){this.data=this.data.map(function(t){return 1-t})},draw(t,e,i,n,h){let a=Math.ceil(e/this.width),r=Math.ceil(i/this.height),o=this.getColorMap(n),l=!!h;console.log(l);for(let e=0;e<this.width;e++)for(let i=0;i<this.height;i++)t.fillStyle=o(this.getData(e,i)),t.fillRect(e*a,i*r,a,r),l&&(t.fillStyle=this.computeShadowStyle(e,i),t.fillRect(e*a,i*r,a,r))},getColorMap:function(t){let e=null;return e="real"==t?function(t){return"rgb("+x(255*t,s)+","+x(255*t,f)+","+x(255*t,c)+")"}:"geo"==t?function(t){return"rgb("+x(255*t,y)+","+x(255*t,M)+","+x(255*t,m)+")"}:"heat"==t?function(t){return"rgb("+x(255*t,d)+","+x(255*t,p)+","+x(255*t,g)+")"}:function(t){return"hsl(0,0%,"+String(100*t)+"%)"}},computeShadowStyle:function(t,e){let i=0,n=this.getData(t,e);return n>=.5&&(this.getData(t-1,e)>n&&(i+=.01),this.getData(t,e-1)>n&&(i+=.02),this.getData(t-1,e-1)>n&&(i+=.03)),"rgba(0,0,0,"+String(i)+")"}},PerlinMap});
